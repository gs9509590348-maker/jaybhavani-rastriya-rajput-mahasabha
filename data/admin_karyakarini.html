<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Admin Panel | рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА рдкреНрд░рдмрдВрдзрди тАУ JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{font-family:Arial;background:#f4f4f4;margin:0}

/* HEADER */
header{background:#7b0000;color:#fff;padding:15px;text-align:center}

/* NAV */
nav{
  background:#3b0000;
  display:flex;flex-wrap:wrap;
  justify-content:center
}
nav a{
  color:#fff;text-decoration:none;
  padding:8px 12px;font-size:14px
}
nav a:hover{background:#7b0000}

/* MAIN */
.container{
  max-width:1100px;margin:20px auto;
  background:#fff;padding:20px;border-radius:10px
}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px;font-size:14px;text-align:center}
th{background:#eee}
img{width:50px;height:50px;border-radius:50%;object-fit:cover}
input,select{width:100%;padding:6px}
button{
  padding:6px 10px;border:none;border-radius:4px;
  cursor:pointer;font-size:13px
}
.up,.down{background:#ffc107}
.delete{background:#dc3545;color:#fff}
.add{background:#28a745;color:#fff}

textarea{width:100%;height:220px}
.note{
  background:#fff3cd;padding:10px;
  border-left:4px solid #ff9800;
  margin-bottom:15px;font-size:13px
}

/* FOOTER */
.footer{text-align:center;font-size:12px;color:#555;margin:30px 10px}
.footer a{color:#7b0000;text-decoration:none}
</style>
</head>

<body>

<script>
/* ЁЯФР ADMIN PROTECTION */
if(sessionStorage.getItem("admin")!=="1"){
  alert("Unauthorized Access");
  location.href="../admin_login.html";
}
</script>

<header>
  <h2>ЁЯФР Admin Panel тАУ рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА рдкреНрд░рдмрдВрдзрди</h2>
  <p>Master Admin Tool</p>
</header>

<!-- ADMIN NAVIGATION -->
<nav>
  <a href="../admin_control.html">ЁЯФР Control Room</a>
  <a href="../admin_dashboard.html">ЁЯУК Dashboard</a>
  <a href="../admin_pending.html">тП│ Pending Members</a>
  <a href="../admin_bulk_approve.html">ЁЯЪА Bulk Approve</a>
  <a href="../bulk_add_members.html">тЮХ Bulk Add Members</a>
  <a href="../bulk_whatsapp.html">ЁЯУ▓ Bulk WhatsApp</a>
  <a href="../admin_edit_member.html">тЬПя╕П Edit Member</a>
  <a href="../admin_karyakarini.html">ЁЯзСтАНЁЯТ╝ рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА</a>
  <a href="../karyakarini.html" target="_blank">ЁЯСе View рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА</a>
  <a href="../members.html" target="_blank">ЁЯзСтАНЁЯдЭтАНЁЯзС Members</a>
  <a href="../verify.html" target="_blank">ЁЯФН Verify</a>
  <a href="../certificate.html" target="_blank">ЁЯУЬ Certificate</a>
  <a href="../idcard_print.html" target="_blank">ЁЯкк ID Card</a>
  <a href="../appointment.html" target="_blank">ЁЯУД Appointment</a>
  <a href="../gallery.html" target="_blank">ЁЯЦ╝я╕П Gallery</a>
  <a href="../events.html" target="_blank">ЁЯУв Events</a>
  <a href="../contact.html" target="_blank">ЁЯУЮ Contact</a>
  <a href="../index.html" target="_blank">ЁЯПа Website</a>
</nav>

<div class="container">

<div class="note">
<b>рдиреЛрдЯ:</b> рд╕рднреА рдмрджрд▓рд╛рд╡ browser рдореЗрдВ рд╣реЛрдВрдЧреЗред  
рдиреАрдЪреЗ рдмрдиреЗ <b>Updated JSON</b> рдХреЛ copy рдХрд░рдХреЗ  
<code>data/karyakarini.json</code> рдореЗрдВ paste рдХрд░реЗрдВред  
<br>ЁЯСЙ GitHub Pages = Static Mode
</div>

<!-- ADD NEW MEMBER -->
<h3>тЮХ рдирдпрд╛ рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА рд╕рджрд╕реНрдп рдЬреЛрдбрд╝реЗрдВ</h3>
<table>
<tr>
<td><input id="n_name" placeholder="Name"></td>
<td><input id="n_post" placeholder="Post"></td>
<td>
<select id="n_level">
  <option>рд░рд╛рд╖реНрдЯреНрд░реАрдп</option>
  <option>рдкреНрд░рджреЗрд╢</option>
  <option>рдЬрд┐рд▓рд╛</option>
</select>
</td>
<td><input id="n_district" placeholder="District"></td>
<td><input id="n_state" placeholder="State"></td>
<td><input id="n_mobile" placeholder="Mobile"></td>
<td><input id="n_photo" placeholder="Photo URL"></td>
<td><button class="add" onclick="addMember()">тЮХ Add</button></td>
</tr>
</table>

<hr>

<!-- EXISTING MEMBERS -->
<h3>тЬПя╕П Edit / Delete / Reorder рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА</h3>
<table>
<thead>
<tr>
<th>Order</th>
<th>Photo</th>
<th>Name</th>
<th>Post</th>
<th>Level</th>
<th>District</th>
<th>State</th>
<th>Mobile</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<h3>ЁЯУж Updated JSON (Copy & Paste)</h3>
<textarea id="jsonOut"></textarea>

</div>

<footer class="footer">
┬й 2025 рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛<br>
Admin Panel тАУ Authorized Use Only<br>
<a href="../privacy.html" target="_blank">Privacy</a> |
<a href="../terms.html" target="_blank">Terms</a> |
<a href="../verify.html" target="_blank">Verify</a>
</footer>

<script>
/* тЬЕ SAFE ABSOLUTE PATH */
const JSON_PATH = "../data/karyakarini.json";
let data=[];

fetch(JSON_PATH)
.then(r=>r.json())
.then(j=>{
  data = j.karyakarini.filter(x=>x.active!==false);
  normalizeOrder();
  render();
})
.catch(()=>alert("karyakarini.json load рдирд╣реАрдВ рд╣реЛ рдкрд╛ рд░рд╣рд╛"));

function normalizeOrder(){
  data.sort((a,b)=>a.order-b.order);
  data.forEach((m,i)=>m.order=i+1);
}
function nextId(){
  return "KAR-" + String(data.length+1).padStart(3,"0");
}

function addMember(){
  if(!n_name.value || !n_post.value){
    alert("Name рдФрд░ Post рдЬрд░реВрд░реА рд╣реИ");
    return;
  }
  data.push({
    id:nextId(),
    name:n_name.value,
    post:n_post.value,
    level:n_level.value,
    district:n_district.value,
    state:n_state.value,
    mobile:n_mobile.value,
    photo:n_photo.value,
    order:data.length+1,
    active:true
  });
  clearNew();render();
}
function clearNew(){
  n_name.value=n_post.value=n_district.value=
  n_state.value=n_mobile.value=n_photo.value="";
}

function render(){
  const tb=document.getElementById("tbody");
  tb.innerHTML="";
  data.forEach((m,i)=>{
    tb.innerHTML+=`
    <tr>
      <td>${m.order}</td>
      <td><img src="${m.photo||'https://via.placeholder.com/50'}"></td>
      <td><input value="${m.name}" onchange="upd(${i},'name',this.value)"></td>
      <td><input value="${m.post}" onchange="upd(${i},'post',this.value)"></td>
      <td>
        <select onchange="upd(${i},'level',this.value)">
          <option ${m.level=='рд░рд╛рд╖реНрдЯреНрд░реАрдп'?'selected':''}>рд░рд╛рд╖реНрдЯреНрд░реАрдп</option>
          <option ${m.level=='рдкреНрд░рджреЗрд╢'?'selected':''}>рдкреНрд░рджреЗрд╢</option>
          <option ${m.level=='рдЬрд┐рд▓рд╛'?'selected':''}>рдЬрд┐рд▓рд╛</option>
        </select>
      </td>
      <td><input value="${m.district||''}" onchange="upd(${i},'district',this.value)"></td>
      <td><input value="${m.state||''}" onchange="upd(${i},'state',this.value)"></td>
      <td><input value="${m.mobile||''}" onchange="upd(${i},'mobile',this.value)"></td>
      <td>
        <button class="up" onclick="moveUp(${i})">тмЖ</button>
        <button class="down" onclick="moveDown(${i})">тмЗ</button>
        <button class="delete" onclick="del(${i})">тЭМ</button>
      </td>
    </tr>`;
  });

  document.getElementById("jsonOut").value =
JSON.stringify({
  last_updated:new Date().toISOString().split("T")[0],
  organization:"рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛",
  karyakarini:data
},null,2);
}

function upd(i,k,v){data[i][k]=v;render();}
function del(i){
  if(confirm("Delete this member?")){
    data.splice(i,1);
    normalizeOrder();render();
  }
}
function moveUp(i){
  if(i===0) return;
  [data[i],data[i-1]]=[data[i-1],data[i]];
  normalizeOrder();render();
}
function moveDown(i){
  if(i===data.length-1) return;
  [data[i],data[i+1]]=[data[i+1],data[i]];
  normalizeOrder();render();
}
</script>

</body>
</html>
