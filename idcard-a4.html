<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>ID Card (A4) | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#eee;margin:0}
.page{
  width:210mm;
  height:297mm;
  background:#fff;
  margin:10px auto;
  padding:20px
}
.card{
  border:2px solid #7b0000;
  padding:20px
}
h2{text-align:center;color:#7b0000;margin:5px 0}
.row{display:flex;gap:20px;align-items:flex-start}
.photo img{
  width:120px;height:120px;
  border-radius:8px;
  border:2px solid #7b0000;
  object-fit:cover
}
.info p{margin:6px 0;font-size:15px}
.qr img{width:120px;height:120px}
.verify{text-align:center;margin-top:30px;font-size:14px}
@media print{
  body{background:#fff}
}
</style>
</head>

<body>

<div class="page">
  <div class="card">
    <h2>जय भवानी राष्ट्रीय राजपूत महासभा</h2>

    <div class="row">
      <div class="photo">
        <img id="photo" src="assets/photo.png">
      </div>

      <div class="info">
        <p><b>Name:</b> <span id="name"></span></p>
        <p><b>District:</b> <span id="district"></span></p>
        <p><b>State:</b> <span id="state"></span></p>
        <p><b>Member ID:</b> <span id="mid"></span></p>
        <p><b>Status:</b> <span id="status"></span></p>
      </div>

      <div class="qr">
        <img id="qr">
      </div>
    </div>

    <div class="verify">
      Verify: https://jbrrms.in/verify.html?id=<span id="vid"></span>
    </div>
  </div>
</div>

<script>
const params = new URLSearchParams(location.search);
const memberId = params.get("id");

if(!memberId){
  alert("Member ID missing");
  throw new Error("No ID");
}

fetch("members.json?v=" + Date.now())
.then(r => r.json())
.then(list => {
  const m = list.find(x => x.member_id === memberId);
  if(!m){
    alert("Member not found");
    return;
  }

  document.getElementById("name").innerText = m.name || "-";
  document.getElementById("district").innerText = m.district || "-";
  document.getElementById("state").innerText = m.state || "-";
  document.getElementById("mid").innerText = m.member_id;
  document.getElementById("status").innerText = m.status || "Approved";
  document.getElementById("vid").innerText = m.member_id;

  // Photo (optional)
  if(m.photo){
    document.getElementById("photo").src = m.photo;
  }

  // QR code
  document.getElementById("qr").src =
    "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=" +
    encodeURIComponent(
      "https://jbrrms.in/verify.html?id=" + m.member_id
    );
})
.catch(err => {
  alert("Data load error");
  console.error(err);
});
</script>

</body>
</html>
