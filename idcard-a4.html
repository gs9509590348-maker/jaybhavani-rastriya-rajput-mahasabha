<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>ID Card (A4) | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{
  font-family:Arial;
  background:#eee;
  margin:0
}
.page{
  width:210mm;
  height:297mm;
  background:#fff;
  margin:10px auto;
  padding:20px
}
.card{
  border:2px solid #7b0000;
  padding:20px
}
h2{
  text-align:center;
  color:#7b0000;
  margin:5px 0 15px
}
.row{
  display:flex;
  gap:20px;
  align-items:flex-start
}
.photo img{
  width:120px;
  height:120px;
  border-radius:8px;
  border:2px solid #7b0000;
  object-fit:cover
}
.info p{
  margin:6px 0;
  font-size:15px
}
.qr img{
  width:120px;
  height:120px
}
.verify{
  text-align:center;
  margin-top:30px;
  font-size:14px;
  word-break:break-all
}
.badge{
  display:inline-block;
  padding:3px 10px;
  border-radius:20px;
  font-size:13px;
  color:#fff
}
.approved{background:#28a745}
.pending{background:#ff9800}
.rejected{background:#dc3545}

@media print{
  body{background:#fff}
  .page{margin:0}
}
</style>
</head>

<body>

<div class="page">
  <div class="card">

    <h2>जय भवानी राष्ट्रीय राजपूत महासभा</h2>

    <div class="row">

      <div class="photo">
        <img id="photo" src="assets/photo.png">
      </div>

      <div class="info">
        <p><b>Name:</b> <span id="name">-</span></p>
        <p><b>District:</b> <span id="district">-</span></p>
        <p><b>State:</b> <span id="state">-</span></p>
        <p><b>Member ID:</b> <span id="mid">-</span></p>
        <p>
          <b>Status:</b>
          <span id="statusBadge" class="badge approved">Approved</span>
        </p>
      </div>

      <div class="qr">
        <img id="qr">
      </div>

    </div>

    <div class="verify">
      Verify:
      <span id="verifyUrl"></span>
    </div>

  </div>
</div>

<script>
const params = new URLSearchParams(location.search);
const memberId = params.get("id");

if(!memberId){
  alert("❌ Member ID missing");
  throw new Error("No Member ID");
}

/* ===== LOAD members.json ===== */
fetch("data/members.json?v=" + Date.now())
.then(r=>{
  if(!r.ok) throw new Error("load error");
  return r.json();
})
.then(list=>{
  const m = list.find(x =>
    x.member_id && x.member_id.toUpperCase() === memberId.toUpperCase()
  );

  if(!m){
    alert("❌ Member not found");
    return;
  }

  /* BASIC INFO */
  name.innerText = m.name || "-";
  district.innerText = m.district || "-";
  state.innerText = m.state || "-";
  mid.innerText = m.member_id;

  /* STATUS */
  const st = (m.status || "approved").toLowerCase();
  statusBadge.innerText = st.charAt(0).toUpperCase() + st.slice(1);
  statusBadge.className = "badge " + st;

  /* PHOTO */
  if(m.photo){
    photo.src = m.photo;
  }

  /* VERIFY URL */
  const verifyLink =
    location.origin + "/verify.html?id=" + m.member_id;

  verifyUrl.innerText = verifyLink;

  /* QR CODE */
  qr.src =
    "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=" +
    encodeURIComponent(verifyLink);
})
.catch(err=>{
  alert("❌ Data load error");
  console.error(err);
});
</script>

</body>
</html>
