<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>рдирд┐рдпреБрдХреНрддрд┐ рдкрддреНрд░ | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  background:#eee;
  font-family:Mangal, Arial, sans-serif;
  margin:0;
}
.letter{
  width:700px;max-width:95%;
  margin:30px auto;background:#fff;
  padding:30px;border:2px solid #7b0000
}
h1{text-align:center;color:#7b0000;margin:0}
.sub{text-align:center;font-size:14px;margin-bottom:20px}
p{font-size:16px;line-height:1.8}
.footer-row{
  display:flex;justify-content:space-between;
  margin-top:40px;font-size:15px
}
.btn{
  display:block;margin:12px auto;
  padding:10px 16px;background:#7b0000;
  color:#fff;border:none;border-radius:6px;
  text-decoration:none;text-align:center;
  font-size:15px;cursor:pointer
}
.gray{background:#555}
.whatsapp{background:#25D366}
.site-footer{
  text-align:center;font-size:13px;
  color:#555;margin:40px 0 20px;line-height:1.6
}
@media print{
  .no-print{display:none}
  body{background:#fff}
}
</style>
</head>

<body>

<div class="letter" id="app">

<h1>тШАя╕П<br>рдирд┐рдпреБрдХреНрддрд┐ рдкрддреНрд░</h1>
<div class="sub">
рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛<br>
(рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╕реНрддрд░ рдХрд╛ рд╕рд╛рдорд╛рдЬрд┐рдХ рд╕рдВрдЧрдарди)
</div>

<p>
рдпрд╣ рдЕрддреНрдпрдВрдд рд╣рд░реНрд╖ рдХрд╛ рд╡рд┐рд╖рдп рд╣реИ рдХрд┐<br><br>

рд╢реНрд░реА <b id="name"></b><br>
рдкрд┐рддрд╛/рдЕрднрд┐рднрд╛рд╡рдХ : <b id="father"></b><br><br>

рдХреЛ рд╕рдВрдЧрдарди рдХреЗ рдкреНрд░рддрд┐ рдирд┐рд╖реНрдард╛, рд╕реЗрд╡рд╛ рднрд╛рд╡рдирд╛
рдПрд╡рдВ рд╕рдХреНрд░рд┐рдп рдпреЛрдЧрджрд╛рди рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП<br><br>

<b>"<span id="post"></span>"</b><br>
<b><span id="level"></span></b> рд╕реНрддрд░<br>
рд╡рд┐рднрд╛рдЧ : <b><span id="dept"></span></b><br>
рдЬрд┐рд▓рд╛ / рдкреНрд░рджреЗрд╢ : <b><span id="area"></span></b><br><br>

рдкрд░ <b>рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛</b> рдореЗрдВ
рдирд┐рдпреБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
</p>

<p>
рдЖрдкрд╕реЗ рдЕрдкреЗрдХреНрд╖рд╛ рд╣реИ рдХрд┐ рдЖрдк рд╕рдВрдЧрдарди рдХреЗ рдирд┐рдпрдореЛрдВ,
рдЕрдиреБрд╢рд╛рд╕рди рдПрд╡рдВ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк
рдкреВрд░реНрдг рдирд┐рд╖реНрдард╛ рд╕реЗ рдХрд╛рд░реНрдп рдХрд░реЗрдВрдЧреЗред
</p>

<p>
рдЖрдкрдХреА рд╕рджрд╕реНрдп рдЖрдИрдбреА : <b id="mid"></b>
</p>

<div class="footer-row">
  <div>
    рдирд┐рдпреБрдХреНрддрд┐ рддрд┐рдерд┐ : <span id="date"></span><br>
    рд╕реНрдерд╛рди : __________
  </div>
  <div style="text-align:right">
    (рдпрд╣ рдкрддреНрд░ рдкреВрд░реНрдгрддрдГ рдбрд┐рдЬрд┐рдЯрд▓ рд╣реИ)<br>
    QR Verify рджреНрд╡рд╛рд░рд╛ рдорд╛рдиреНрдп
  </div>
</div>

<p style="text-align:center;font-weight:bold;margin-top:30px">
рдЬрдп рднрд╡рд╛рдиреА | рдЬрдп рд░рд╛рдЬрдкреВрддрд╛рдирд╛ ЁЯЪй
</p>

</div>

<button class="btn no-print" onclick="window.print()">ЁЯЦия╕П Print / Save PDF</button>
<button class="btn no-print" onclick="download()">тмЗя╕П Download Appointment</button>

<a id="idcard" class="btn gray no-print" target="_blank">ЁЯкк View ID Card</a>
<a id="verify" class="btn gray no-print" target="_blank">ЁЯФН Verify Online</a>
<button class="btn whatsapp no-print" onclick="shareWhatsApp()">ЁЯУ▓ Share on WhatsApp</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
const qs = new URLSearchParams(location.search);
const memberId = qs.get("id");

let member = null;

if(!memberId){
  alert("тЭМ Member ID missing");
  throw new Error("No Member ID");
}

/* ===== LOAD members.json ===== */
fetch("data/members.json?v=" + Date.now())
.then(r=>{
  if(!r.ok) throw new Error("load error");
  return r.json();
})
.then(list=>{
  member = list.find(x =>
    x.member_id && x.member_id.toUpperCase() === memberId.toUpperCase()
  );

  if(!member){
    alert("тЭМ Member not found");
    return;
  }

  /* ===== FILL LETTER ===== */
  name.innerText   = member.name || "";
  father.innerText = member.father || "";
  post.innerText   = member.post || "";
  level.innerText  = member.level || "";
  dept.innerText   = member.department || "";
  area.innerText   =
    (member.district||"") + " / " + (member.state||"");

  mid.innerText  = member.member_id;
  date.innerText = new Date().toLocaleDateString("hi-IN");

  /* ===== LINKS ===== */
  idcard.href = "idcard-a4.html?id=" + member.member_id;
  verify.href = "verify.html?id=" + member.member_id;
})
.catch(()=>{
  alert("тЭМ members.json load рдирд╣реАрдВ рд╣реБрдЖ");
});

/* ===== DOWNLOAD AS IMAGE ===== */
function download(){
  html2canvas(document.getElementById("app"),{scale:2})
  .then(c=>{
    const a=document.createElement("a");
    a.download="JBRRMS_Appointment_"+memberId+".png";
    a.href=c.toDataURL("image/png");
    a.click();
  });
}

/* ===== WHATSAPP SHARE ===== */
function shareWhatsApp(){
  if(!member) return;

  const msg =
`рдореИрдВ рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛ рдХрд╛ рдирд┐рдпреБрдХреНрдд рд╕рджрд╕реНрдп рд╣реВрдБ тЬЕ

рдирд╛рдо: ${member.name}
рдкрдж: ${member.post || ""}
Member ID: ${member.member_id}

Verify Online ЁЯСЗ
${location.origin}/verify.html?id=${member.member_id}`;

  window.open(
    "https://wa.me/?text="+encodeURIComponent(msg),
    "_blank"
  );
}
</script>

<footer class="site-footer">
┬й 2026 рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛<br>
рдпрд╣ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЗрд╡рд▓ рд╕рдВрдЧрдардирд╛рддреНрдордХ рдЬрд╛рдирдХрд╛рд░реА рд╣реЗрддреБ рд╣реИред<br>
рдпрд╣ рдХрд┐рд╕реА рд╕рд░рдХрд╛рд░реА рд╕рдВрд╕реНрдерд╛ рд╕реЗ рд╕рдВрдмрджреНрдз рдирд╣реАрдВ рд╣реИред
</footer>

</body>
</html>
