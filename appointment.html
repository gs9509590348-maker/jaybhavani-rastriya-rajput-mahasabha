<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Appointment Letter | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{background:#eee;font-family:Arial}
.letter{
  width:700px;max-width:95%;
  margin:30px auto;background:#fff;
  padding:30px;border:2px solid #7b0000
}
h1{text-align:center;color:#7b0000;margin:0}
p{font-size:16px;line-height:1.6}
.footer{display:flex;justify-content:space-between;margin-top:40px}

.btn{
  display:block;margin:12px auto;padding:10px 16px;
  background:#7b0000;color:#fff;border:none;
  border-radius:6px;text-decoration:none;
  text-align:center;font-size:15px;
}
.whatsapp{background:#25D366}
.gray{background:#555}
</style>
</head>

<body>

<div class="letter" id="app">
  <h1>рдирд┐рдпреБрдХреНрддрд┐ рдкрддреНрд░</h1>

  <p>
    рд╢реНрд░реА <b id="name"></b> (рдкрд┐рддрд╛: <b id="father"></b>)  
    рдХреЛ рдпрд╣ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ
    <b>рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛</b> рдореЗрдВ
    <b id="level"></b> рд╕реНрддрд░ рдкрд░
    <b id="post"></b> (рд╡рд┐рднрд╛рдЧ: <b id="dept"></b>)
    рдХреЗ рдкрдж рдкрд░ рдирд┐рдпреБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
  </p>

  <p>
    рдЖрдкрдХреА рд╕рджрд╕реНрдп рдЖрдИрдбреА: <b id="mid"></b>
  </p>

  <div class="footer">
    <div>рджрд┐рдирд╛рдВрдХ: <span id="date"></span></div>
    <div>рд╣рд╕реНрддрд╛рдХреНрд╖рд░ / рдореБрд╣рд░</div>
  </div>
</div>

<button class="btn" onclick="download()">тмЗя╕П Download Appointment</button>

<a id="idcard" class="btn gray" target="_blank">ЁЯкк View ID Card</a>
<a id="certificate" class="btn gray" target="_blank">ЁЯУЬ View Certificate</a>

<a class="btn whatsapp" onclick="shareWhatsApp()">ЁЯУ▓ Share on WhatsApp</a>

<a id="verify" class="btn gray" target="_blank">ЁЯФН Verify Online</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
const id = new URLSearchParams(location.search).get("id");
let member = null;

fetch("data/members.json")
.then(r=>r.json())
.then(d=>{
  member = d.find(x=>x.member_id === id);
  if(!member){ alert("Member not found"); return; }

  name.innerText = member.name;
  father.innerText = member.father;
  level.innerText = member.level;
  post.innerText = member.post;
  dept.innerText = member.department;
  mid.innerText = member.member_id;
  date.innerText = new Date().toLocaleDateString("hi-IN");

  document.getElementById("idcard").href = member.id_card;
  document.getElementById("certificate").href = member.certificate;
  document.getElementById("verify").href =
    "https://jbrrms.in/verify.html?id=" + member.member_id;
});

function download(){
  html2canvas(document.getElementById("app")).then(c=>{
    const a=document.createElement("a");
    a.download="JBRRMS_Appointment_"+id+".png";
    a.href=c.toDataURL();
    a.click();
  });
}

function shareWhatsApp(){
  const msg =
    "рдореИрдВ рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛ рдХрд╛ рдирд┐рдпреБрдХреНрдд рд╕рджрд╕реНрдп рд╣реВрдБ тЬЕ\n\n" +
    "Name: " + member.name + "\n" +
    "Post: " + member.post + "\n" +
    "Member ID: " + member.member_id + "\n\n" +
    "Verify Online ЁЯСЗ\n" +
    "https://jbrrms.in/verify.html?id=" + member.member_id;

  window.open(
    "https://wa.me/?text=" + encodeURIComponent(msg),
    "_blank"
  );
}
</script>

</body>
</html>
