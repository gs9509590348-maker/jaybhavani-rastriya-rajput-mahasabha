<!DOCTYPE html>
<html lang="hi">
<head>
Â Â <meta charset="UTF-8">
Â Â <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â Â <title>JBRRMS â€“ Royal ID Card</title>
Â Â <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
Â Â <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
Â Â <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
Â Â <style>
Â Â Â Â body {
Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â background: #0e0e0e;
Â Â Â Â Â Â font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
Â Â Â Â Â Â color: #fff;
Â Â Â Â Â Â touch-action: manipulation;
Â Â Â Â }
Â Â Â Â #joinBox {
Â Â Â Â Â Â max-width: 360px;
Â Â Â Â Â Â background: #fff;
Â Â Â Â Â Â color: #000;
Â Â Â Â Â Â margin: 20px auto;
Â Â Â Â Â Â padding: 20px;
Â Â Â Â Â Â border-radius: 16px;
Â Â Â Â Â Â box-shadow: 0 8px 32px rgba(0,0,0,0.4);
Â Â Â Â }
Â Â Â Â h2 { text-align: center; margin: 0 0 16px; }
Â Â Â Â input, button {
Â Â Â Â Â Â width: 100%;
Â Â Â Â Â Â padding: 12px;
Â Â Â Â Â Â margin: 8px 0;
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â border-radius: 8px;
Â Â Â Â Â Â border: 1px solid #ccc;
Â Â Â Â Â Â box-sizing: border-box;
Â Â Â Â }
Â Â Â Â button {
Â Â Â Â Â Â background: #c69214;
Â Â Â Â Â Â color: white;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â transition: background 0.2s;
Â Â Â Â }
Â Â Â Â button:hover { background: #d4a017; }
Â Â Â Â button:disabled { opacity: 0.6; cursor: not-allowed; }
Â Â Â Â .card {
Â Â Â Â Â Â display: none;
Â Â Â Â Â Â position: relative;
Â Â Â Â Â Â width: 1080px;
Â Â Â Â Â Â height: 1676px;
Â Â Â Â Â Â margin: 20px auto;
Â Â Â Â Â Â background-size: cover;
Â Â Â Â Â Â border-radius: 16px;
Â Â Â Â Â Â overflow: hidden;
Â Â Â Â Â Â max-width: 100%;
Â Â Â Â Â Â aspect-ratio: 1080 / 1676;
Â Â Â Â }
Â Â Â Â #front { background-image: url("https://ejdzdptqxelilkseannw.supabase.co/storage/v1/object/public/members/idcard_front.png"); }
Â Â Â Â #backÂ Â { background-image: url("https://ejdzdptqxelilkseannw.supabase.co/storage/v1/object/public/members/idcard_back.png"); }
Â Â Â Â .front-title, .back-title {
Â Â Â Â Â Â position: absolute;
Â Â Â Â Â Â width: 100%;
Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â font-weight: 900;
Â Â Â Â Â Â font-size: clamp(40px, 5vw, 58px);
Â Â Â Â Â Â background: linear-gradient(90deg, #fff2b0, #f5c542, #d4af37);
Â Â Â Â Â Â -webkit-background-clip: text;
Â Â Â Â Â Â -webkit-text-fill-color: transparent;
Â Â Â Â }
Â Â Â Â .front-title { top: 23.5%; }
Â Â Â Â .back-titleÂ Â { top: 12%; }
Â Â Â Â .photo {
Â Â Â Â Â Â position: absolute;
Â Â Â Â Â Â top: 29.8%;
Â Â Â Â Â Â left: 36%;
Â Â Â Â Â Â width: 28%;
Â Â Â Â Â Â height: 22.6%;
Â Â Â Â Â Â border-radius: 26px;
Â Â Â Â Â Â overflow: hidden;
Â Â Â Â Â Â border: 14px solid #d4af37;
Â Â Â Â Â Â background: #fff;
Â Â Â Â }
Â Â Â Â .photo img { width: 100%; height: 100%; object-fit: cover; }
Â Â Â Â .details {
Â Â Â Â Â Â position: absolute;
Â Â Â Â Â Â top: 55.4%;
Â Â Â Â Â Â left: 26%;
Â Â Â Â Â Â font-size: clamp(32px, 4.8vw, 52px);
Â Â Â Â Â Â line-height: 1.45;
Â Â Â Â Â Â color: #000;
Â Â Â Â }
Â Â Â Â #c_code { margin-top: 12px; font-weight: 900; letter-spacing: 2px; }
Â Â Â Â #qr { position: absolute; top: 22.6%; left: 50%; transform: translateX(-50%); }
Â Â Â Â .seven-lines {
Â Â Â Â Â Â position: absolute;
Â Â Â Â Â Â top: 43%;
Â Â Â Â Â Â left: 50%;
Â Â Â Â Â Â transform: translateX(-50%);
Â Â Â Â Â Â width: 70%;
Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â font-size: 20px;
Â Â Â Â Â Â line-height: 1.5;
Â Â Â Â Â Â color: #000;
Â Â Â Â }
Â Â Â Â .back-footer { position: absolute; bottom: 7%; width: 100%; text-align: center; font-size: 26px; color: #000; }
Â Â Â Â .disclaimer { position: absolute; bottom: 2.5%; width: 100%; text-align: center; font-size: 20px; opacity: 0.8; color: #000; }
Â Â Â Â .actions { text-align: center; margin: 24px 0; }
Â Â Â Â .actions button { width: 140px; margin: 0 8px; }
Â Â Â Â #loading {
Â Â Â Â Â Â display: none;
Â Â Â Â Â Â position: fixed;
Â Â Â Â Â Â inset: 0;
Â Â Â Â Â Â background: rgba(0,0,0,0.7);
Â Â Â Â Â Â color: white;
Â Â Â Â Â Â place-items: center;
Â Â Â Â Â Â font-size: 1.3rem;
Â Â Â Â Â Â z-index: 1000;
Â Â Â Â }
Â Â </style>
</head>
<body>
<div id="joinBox">
Â Â <h2>JBRRMS Join / Search</h2>
Â Â <input id="name" placeholder="à¤ªà¥‚à¤°à¤¾ à¤¨à¤¾à¤® *" required>
Â Â <input id="father" placeholder="à¤ªà¤¿à¤¤à¤¾ à¤•à¤¾ à¤¨à¤¾à¤®">
Â Â <input id="post" placeholder="à¤ªà¤¦ *" required>
Â Â <input id="district" placeholder="à¤œà¤¿à¤²à¤¾">
Â Â <input id="state" placeholder="à¤°à¤¾à¤œà¥à¤¯">
Â Â <input id="mobile" placeholder="à¤®à¥‹à¤¬à¤¾à¤‡à¤²" inputmode="numeric" pattern="\d{10}">
Â Â <input type="file" id="photoInput" accept="image/*" required>
Â Â <button id="joinBtn">Join Now</button>
Â Â <hr>
Â Â <input id="searchCode" placeholder="Member Code (à¤‰à¤¦à¤¾: JBRRMS0001)">
Â Â <button id="searchBtn">ğŸ†” Search ID Card</button>
</div>
<div id="front" class="card"><div class="front-title">à¤œà¤¯ à¤­à¤µà¤¾à¤¨à¥€ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤°à¤¾à¤œà¤ªà¥‚à¤¤ à¤®à¤¹à¤¾à¤¸à¤­à¤¾</div>
Â Â <div class="photo"><img id="cardPhoto" alt="Member Photo" crossorigin="anonymous"></div>
Â Â <div class="details">
Â Â Â Â <div><b>à¤¨à¤¾à¤® :</b> <span id="c_name"></span></div>
Â Â Â Â <div><b>à¤ªà¤¦ :</b> <span id="c_post"></span></div>
Â Â Â Â <div><b>à¤ªà¤¿à¤¤à¤¾ :</b> <span id="c_father"></span></div>
Â Â Â Â <div><b>à¤œà¤¿à¤²à¤¾ :</b> <span id="c_district"></span></div>
Â Â Â Â <div><b>à¤°à¤¾à¤œà¥à¤¯ :</b> <span id="c_state"></span></div>
Â Â Â Â <div><b>à¤®à¥‹à¤¬à¤¾à¤‡à¤² :</b> <span id="c_mobile"></span></div>
Â Â Â Â <div id="c_code"></div>
Â Â </div>
</div>
<div id="back" class="card">
Â Â <div class="back-title">à¤œà¤¯ à¤­à¤µà¤¾à¤¨à¥€ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤°à¤¾à¤œà¤ªà¥‚à¤¤ à¤®à¤¹à¤¾à¤¸à¤­à¤¾</div>
Â Â <div id="qr"></div>
Â Â <div class="seven-lines">
Â Â Â Â à¤ªà¤¦ à¤¸à¥‡ à¤¬à¤¡à¤¼à¤¾ à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆà¥¤<br>à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤¹à¥ˆ à¤¤à¥‹ à¤ªà¤¹à¤šà¤¾à¤¨ à¤¹à¥ˆà¥¤<br>à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤•à¤­à¥€ à¤—à¤¿à¤°à¤µà¥€ à¤¨à¤¹à¥€à¤‚ à¤°à¤–à¤¾ à¤œà¤¾à¤¤à¤¾à¥¤<br>à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤¹à¥€ à¤…à¤¸à¤²à¥€ à¤¶à¤•à¥à¤¤à¤¿ à¤¹à¥ˆà¥¤<br>à¤œà¤¿à¤¸à¤•à¥‡ à¤ªà¤¾à¤¸ à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤¹à¥ˆ, à¤µà¤¹à¥€ à¤¸à¤šà¥à¤šà¤¾ à¤¬à¤²à¤µà¤¾à¤¨ à¤¹à¥ˆà¥¤<br>à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤¸à¤®à¤à¥Œà¤¤à¤¾ à¤¨à¤¹à¥€à¤‚ à¤¸à¤¿à¤–à¤¾à¤¤à¤¾à¥¤<br>à¤¸à¥à¤µà¤¾à¤­à¤¿à¤®à¤¾à¤¨ à¤¹à¤®à¤¾à¤°à¥€ à¤…à¤¸à¤²à¥€ à¤µà¤¿à¤°à¤¾à¤¸à¤¤ à¤¹à¥ˆà¥¤
Â Â </div>
Â Â <div class="back-footer">
Â Â Â Â à¤¹à¥‡à¤²à¥à¤ªà¤²à¤¾à¤‡à¤¨: 9166377972<br>Email: jbrrms1@gmail.com<br>Website: www.jbrrms.in
Â Â </div>
Â Â <div class="disclaimer">à¤¯à¤¹ à¤ªà¤¹à¤šà¤¾à¤¨ à¤ªà¤¤à¥à¤° à¤¸à¤‚à¤—à¤ à¤¨à¤¾à¤¤à¥à¤®à¤• à¤ªà¥à¤°à¤¯à¥‹à¤œà¤¨à¥‹à¤‚ à¤¹à¥‡à¤¤à¥ à¤¹à¥ˆà¥¤</div>
</div>
<div class="actions">
Â Â <button onclick="showCard('front')">â¬… Front</button>
Â Â <button onclick="showCard('back')">Back â¡</button>
Â Â <button onclick="downloadCard()">â¬‡ Download</button>
</div>
<div id="loading">à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾ à¤•à¤°à¥‡à¤‚...</div>
<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â Constants & Supabase Client
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SUPABASE_URL = "https://ejdzdptqxelilkseannw.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVqZHpkcHRxeGVsaWxrc2Vhbm53Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MTE2MTYsImV4cCI6MjA4MzI4NzYxNn0.j3V1D7Ha2SlKwM9cCCHXlFOzAACQZQ4PVXBIkLq4_cc";
const CLOUD_NAME = "dlqr73p7j";
const UPLOAD_PRESET = "jbrrms_members"; // â† à¤…à¤ªà¤¨à¤¾ Unsigned Preset Name à¤¯à¤¹à¤¾à¤ à¤¡à¤¾à¤²à¥‡à¤‚
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â DOM Cache + State
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const els = {
Â Â joinBox: document.getElementById("joinBox"),
Â Â front: document.getElementById("front"),
Â Â back: document.getElementById("back"),
Â Â cardPhoto: document.getElementById("cardPhoto"),
Â Â qr: document.getElementById("qr"),
Â Â c_name: document.getElementById("c_name"),
Â Â c_post: document.getElementById("c_post"),
Â Â c_father: document.getElementById("c_father"),
Â Â c_district: document.getElementById("c_district"),
Â Â c_state: document.getElementById("c_state"),
Â Â c_mobile: document.getElementById("c_mobile"),
Â Â c_code: document.getElementById("c_code"),
Â Â name: document.getElementById("name"),
Â Â father: document.getElementById("father"),
Â Â post: document.getElementById("post"),
Â Â district: document.getElementById("district"),
Â Â state: document.getElementById("state"),
Â Â mobile: document.getElementById("mobile"),
Â Â photoInput: document.getElementById("photoInput"),
Â Â searchCode: document.getElementById("searchCode"),
Â Â joinBtn: document.getElementById("joinBtn"),
Â Â searchBtn: document.getElementById("searchBtn"),
Â Â loading: document.getElementById("loading")
};
let photoBlob = null;
let currentSide = "front";
let isUploading = false;
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â Helpers
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const showLoading = show => els.loading.style.display = show ? "grid" : "none";
const sanitize = str => String(str || "").trim().replace(/[<>]/g, "");
const showCard = side => {
Â Â currentSide = side;
Â Â els.front.style.display = side === "front" ? "block" : "none";
Â Â els.back.style.display = side === "back" ? "block" : "none";
};
const clearPhoto = () => {
Â Â if (photoBlob) {
Â Â Â Â URL.revokeObjectURL(photoBlob);
Â Â Â Â photoBlob = null;
Â Â }
};
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â Photo Processing (Fast square crop)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
els.photoInput.onchange = async e => {
Â Â const file = e.target.files?.[0];
Â Â if (!file?.type.startsWith("image/")) return;
Â Â const img = new Image();
Â Â const url = URL.createObjectURL(file);
Â Â img.src = url;
Â Â await new Promise(r => img.onload = r);
Â Â const canvas = document.createElement("canvas");
Â Â canvas.width = canvas.height = 600;
Â Â const ctx = canvas.getContext("2d");
Â Â const size = Math.min(img.width, img.height);
Â Â ctx.drawImage(img, (img.width - size)/2, (img.height - size)/2, size, size, 0, 0, 600, 600);
Â Â canvas.toBlob(blob => {
Â Â Â Â photoBlob = blob;
Â Â Â Â URL.revokeObjectURL(url);
Â Â }, "image/jpeg", 0.88);
};
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â JOIN - Main Function (Optimized)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
els.joinBtn.onclick = async () => {
Â Â if (isUploading) return;
Â Â if (!els.name.value.trim() || !els.post.value.trim() || !photoBlob) {
Â Â Â Â return alert("à¤¨à¤¾à¤®, à¤ªà¤¦ à¤”à¤° à¤«à¥‹à¤Ÿà¥‹ à¤…à¤¨à¤¿à¤µà¤¾à¤°à¥à¤¯ à¤¹à¥ˆà¤‚!");
Â Â }
Â Â if (els.mobile.value && !/^\d{10}$/.test(els.mobile.value)) {
Â Â Â Â return alert("à¤®à¥‹à¤¬à¤¾à¤‡à¤² 10 à¤…à¤‚à¤• à¤•à¤¾ à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤!");
Â Â }
Â Â isUploading = true;
Â Â showLoading(true);
Â Â els.joinBtn.disabled = true;
Â Â try {
Â Â Â Â const formData = new FormData();
Â Â Â Â formData.append("file", photoBlob);
Â Â Â Â formData.append("upload_preset", UPLOAD_PRESET);
Â Â Â Â const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
Â Â Â Â Â Â method: "POST",
Â Â Â Â Â Â body: formData
Â Â Â Â });
Â Â Â Â const data = await res.json();
Â Â Â Â if (!res.ok || !data.secure_url) {
Â Â Â Â Â Â throw new Error(data.error?.message || "Upload failed");
Â Â Â Â }
Â Â Â Â const payload = {
Â Â Â Â Â Â name: sanitize(els.name.value),
Â Â Â Â Â Â father_name: sanitize(els.father.value),
Â Â Â Â Â Â post: sanitize(els.post.value),
Â Â Â Â Â Â district: sanitize(els.district.value),
Â Â Â Â Â Â state: sanitize(els.state.value),
Â Â Â Â Â Â mobile: els.mobile.value.trim(),
Â Â Â Â Â Â photo_url: data.secure_url
Â Â Â Â };
Â Â Â Â const { data: inserted, error } = await sb
Â Â Â Â Â Â .from("JBRRMS")
Â Â Â Â Â Â .insert([payload])
Â Â Â Â Â Â .select("member_code")
Â Â Â Â Â Â .single();
Â Â Â Â if (error) throw error;
Â Â Â Â alert(`à¤¸à¤«à¤²! à¤†à¤ªà¤•à¤¾ Member Code: ${inserted.member_code}`);
Â Â Â Â els.searchCode.value = inserted.member_code;
Â Â Â Â await searchMember();
Â Â } catch (err) {
Â Â Â Â console.error(err);
Â Â Â Â alert("à¤¤à¥à¤°à¥à¤Ÿà¤¿: " + (err.message || "à¤•à¥à¤› à¤—à¤²à¤¤ à¤¹à¥à¤†à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¦à¥‹à¤¬à¤¾à¤°à¤¾ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤"));
Â Â } finally {
Â Â Â Â showLoading(false);
Â Â Â Â els.joinBtn.disabled = false;
Â Â Â Â isUploading = false;
Â Â Â Â clearPhoto(); // Free memory
Â Â }
};
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â SEARCH (Optimized)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function searchMember() {
Â Â const code = els.searchCode.value.trim();
Â Â if (!code) return alert("Member Code à¤¡à¤¾à¤²à¥‡à¤‚!");
Â Â showLoading(true);
Â Â els.searchBtn.disabled = true;
Â Â try {
Â Â Â Â els.cardPhoto.src = "";
Â Â Â Â const { data, error } = await sb
Â Â Â Â Â Â .from("JBRRMS")
Â Â Â Â Â Â .select("*")
Â Â Â Â Â Â .eq("member_code", code.toUpperCase())
Â Â Â Â Â Â .single();
Â Â Â Â if (error || !data) throw new Error("à¤¸à¤¦à¤¸à¥à¤¯ à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾");
Â Â Â Â els.joinBox.style.display = "none";
Â Â Â Â showCard("front");
Â Â Â Â els.c_name.textContent = data.name || "";
Â Â Â Â els.c_post.textContent = data.post || "";
Â Â Â Â els.c_father.textContent = data.father_name || "";
Â Â Â Â els.c_district.textContent = data.district || "";
Â Â Â Â els.c_state.textContent = data.state || "";
Â Â Â Â els.c_mobile.textContent = data.mobile || "";
Â Â Â Â els.c_code.textContent = data.member_code || "";
Â Â Â Â els.cardPhoto.src = data.photo_url || "";
Â Â Â Â els.cardPhoto.onerror = () => (els.cardPhoto.src = "");
Â Â Â Â els.qr.innerHTML = "";
Â Â Â Â new QRCode(els.qr, {
Â Â Â Â Â Â text: data.member_code,
Â Â Â Â Â Â width: 280,
Â Â Â Â Â Â height: 280,
Â Â Â Â Â Â colorDark: "#000000",
Â Â Â Â Â Â colorLight: "#ffffff",
Â Â Â Â Â Â correctLevel: QRCode.CorrectLevel.M // faster generation
Â Â Â Â });
Â Â } catch (err) {
Â Â Â Â alert(err.message || "Member à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾!");
Â Â } finally {
Â Â Â Â showLoading(false);
Â Â Â Â els.searchBtn.disabled = false;
Â Â }
}
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//Â Â DOWNLOAD (Improved quality + filename)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function downloadCard() {
Â Â const target = currentSide === "front" ? els.front : els.back;
Â Â showLoading(true);
Â Â html2canvas(target, {
Â Â Â Â scale: 2,
Â Â Â Â useCORS: true,
Â Â Â Â backgroundColor: null,
Â Â Â Â logging: false
Â Â })
Â Â .then(canvas => {
Â Â Â Â const link = document.createElement("a");
Â Â Â Â link.download = `JBRRMS_\( {currentSide}_ \){els.c_code.textContent || "card"}.png`;
Â Â Â Â link.href = canvas.toDataURL("image/png", 0.95);
Â Â Â Â link.click();
Â Â })
Â Â .catch(err => alert("à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡ à¤µà¤¿à¤«à¤²: " + err.message))
Â Â .finally(() => showLoading(false));
}
// Event Listeners
els.searchBtn.onclick = searchMember;
els.searchCode.onkeydown = e => { if (e.key === "Enter") searchMember(); };
</script>
</body>
</html>
