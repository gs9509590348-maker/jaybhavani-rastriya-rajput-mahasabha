<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Member Dashboard | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial, sans-serif;
  background:#f4f4f4;
  margin:0;
}
.card{
  background:#fff;
  margin:40px auto;
  padding:25px;
  max-width:520px;
  border-radius:10px;
  box-shadow:0 4px 15px rgba(0,0,0,.15);
}
h2{color:#7b0000;margin-top:0}
hr{margin:15px 0}
a{
  display:block;
  margin:8px 0;
  color:#7b0000;
  font-weight:bold;
  text-decoration:none;
}
a:hover{text-decoration:underline}
button{
  padding:12px;
  width:100%;
  background:#7b0000;
  color:#fff;
  border:none;
  border-radius:6px;
  font-size:15px;
  cursor:pointer;
  margin-top:15px;
}
.small{
  font-size:13px;
  color:#555;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="card" id="out">
  Loading...
</div>

<script>
let session = null;

/* ===== LOAD SESSION ===== */
try{
  session = JSON.parse(localStorage.getItem("jbr_member"));
}catch(e){
  session = null;
}

/* ===== SESSION CHECK ===== */
if(!session || !session.id){
  location.href = "member_login.html";
}

/* ===== VALIDATE FROM GITHUB MEMBERS.JSON ===== */
fetch("https://gs9509590348-maker.github.io/jaybhavani-rastriya-rajput-mahasabha/members.json")
.then(r => r.json())
.then(list => {

  const m = list.find(x =>
    x.id && x.id.trim().toUpperCase() === session.id.trim().toUpperCase()
  );

  if(!m){
    localStorage.removeItem("jbr_member");
    location.href = "member_login.html";
    return;
  }

  render(m);
})
.catch(()=>{
  alert("âŒ Server error, please login again");
  localStorage.removeItem("jbr_member");
  location.href = "member_login.html";
});

/* ===== RENDER DASHBOARD ===== */
function render(m){
  const mid = m.id;

  document.getElementById("out").innerHTML = `
    <h2>âœ… Welcome ${m.name || "Member"}</h2>

    <p>
      <b>Member ID:</b> ${mid}<br>
      <b>Post:</b> ${m.post || "-"}<br>
      <b>Department:</b> ${m.department || "-"}<br>
      <b>District:</b> ${m.district || "-"}<br>
      <b>State:</b> ${m.state || "-"}
    </p>

    <hr>

    <a href="idcard_a4.html?id=${mid}" target="_blank">ğŸªª ID Card (A4)</a>
    <a href="idcard_pvc.html?id=${mid}" target="_blank">ğŸªª ID Card (PVC)</a>
    <a href="certificate.html?id=${mid}" target="_blank">ğŸ“„ Certificate</a>
    <a href="appointment.html?id=${mid}" target="_blank">ğŸ“œ Appointment Letter</a>
    <a href="verify.html?id=${mid}" target="_blank">ğŸ” Public Verification</a>

    <button onclick="logout()">ğŸšª Logout</button>

    <div class="small">
      âš ï¸ à¤¯à¤¹ dashboard à¤•à¥‡à¤µà¤² logged-in à¤¸à¤¦à¤¸à¥à¤¯ à¤•à¥‡ à¤²à¤¿à¤ à¤¹à¥ˆ
    </div>
  `;
}

/* ===== LOGOUT ===== */
function logout(){
  localStorage.removeItem("jbr_member");
  location.href = "member_login.html";
}
</script>

</body>
</html>
