<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>ID Card A4 Print | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@media print{
  body{margin:0}
  .no-print{display:none}
}
body{font-family:Arial,sans-serif;background:#eee}

/* A4 PAGE */
.page{
  width:210mm;
  min-height:297mm;
  background:#fff;
  margin:10px auto;
  padding:8mm;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8mm;
}

/* CARD */
.card{
  position:relative;
  border:2px solid #7b0000;
  border-radius:10px;
  height:54mm;
  padding:5mm;
  overflow:hidden;
}

.hdr{
  background:#7b0000;
  color:#fff;
  text-align:center;
  font-weight:bold;
  font-size:12px;
  padding:3mm;
  border-radius:6px;
}

.body{
  display:flex;
  margin-top:4mm;
  gap:4mm;
}

.photo img{
  width:22mm;
  height:26mm;
  object-fit:cover;
  border:1px solid #7b0000;
}

.info{
  font-size:11px;
  line-height:1.4;
}

.info a{
  color:#000;
  text-decoration:none;
}

.qr{
  position:absolute;
  bottom:4mm;
  right:4mm;
}
.qr img{width:20mm}

.watermark{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:36px;
  opacity:.07;
  transform:rotate(-20deg);
  font-weight:bold;
}

.back{
  font-size:10px;
  margin-top:3mm;
  border-top:1px dashed #999;
  padding-top:2mm;
  text-align:center;
}

.no-print{text-align:center;margin:10px}
button{
  padding:10px 16px;
  background:#7b0000;
  color:#fff;
  border:none;
  border-radius:6px;
  font-size:15px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="no-print">
  <button onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>
</div>

<div class="page">
  <div class="grid" id="cards"></div>
</div>

<script>
const wrap = document.getElementById("cards");
const qs = new URLSearchParams(location.search);
const onlyId = qs.get("id");

/* ===== LOAD MEMBERS.JSON FROM GITHUB ===== */
fetch("https://gs9509590348-maker.github.io/jaybhavani-rastriya-rajput-mahasabha/members.json")
.then(r=>r.json())
.then(data=>{

  const members = Array.isArray(data) ? data : [];

  const list = onlyId
    ? members.filter(m =>
        m.id && m.id.trim().toUpperCase() === onlyId.trim().toUpperCase()
      )
    : members.filter(m => m.id);

  if(!list.length){
    alert("‚ùå Member ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ");
    return;
  }

  list.forEach(m=>{
    const mid = m.id;
    const mob = String(m.mobile||"").replace(/\D/g,"");

    const verifyURL = `https://jbrrms.in/verify.html?id=${mid}`;
    const waURL = mob ? `https://wa.me/91${mob}` : "#";

    const card = document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <div class="watermark">JBRRMS</div>

      <div class="hdr">‡§ú‡§Ø ‡§≠‡§µ‡§æ‡§®‡•Ä ‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Ø ‡§∞‡§æ‡§ú‡§™‡•Ç‡§§ ‡§Æ‡§π‡§æ‡§∏‡§≠‡§æ</div>

      <div class="body">
        <div class="photo">
          <img src="${m.photo || 'https://via.placeholder.com/150'}">
        </div>
        <div class="info">
          <b>${m.name || ""}</b><br>
          ‡§™‡§ø‡§§‡§æ: ${m.father || ""}<br>
          ‡§™‡§¶: ${m.post || ""}<br>
          ‡§∏‡•ç‡§§‡§∞: ${m.level || ""}<br>
          ID: <b>${mid}</b><br>
          ${mob ? `üìû <a href="tel:+91${mob}">${mob}</a><br>` : ``}
          ${mob ? `üí¨ <a href="${waURL}" target="_blank">WhatsApp</a>` : ``}
        </div>
      </div>

      <div class="qr">
        <a href="${verifyURL}" target="_blank">
          <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(verifyURL)}">
        </a>
      </div>

      <div class="back">
        ‡§Ø‡§π ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ú‡§Ø ‡§≠‡§µ‡§æ‡§®‡•Ä ‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Ø ‡§∞‡§æ‡§ú‡§™‡•Ç‡§§ ‡§Æ‡§π‡§æ‡§∏‡§≠‡§æ ‡§ï‡•Ä ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§π‡•à‡•§<br>
        ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§®: <a href="${verifyURL}" target="_blank">jbrrms.in</a>
      </div>
    `;
    wrap.appendChild(card);
  });
})
.catch(()=>alert("‚ùå members.json load ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü"));
</script>

</body>
</html>
