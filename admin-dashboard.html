<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard - JB RRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:system-ui;background:#f3f3f3;padding:10px}
.card{background:#fff;padding:15px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.2);margin-bottom:15px}
h2{text-align:center}
button{padding:8px 10px;border:none;border-radius:8px;margin-right:6px}
.approve{background:#0a7a20;color:#fff}
.reject{background:#8b0000;color:#fff}
.delete{background:#000;color:#fff}
.status{font-weight:bold}
</style>
</head>

<body>

<h2>üõ° Admin Dashboard</h2>

<div id="memberList"></div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, getDocs, updateDoc, deleteDoc, doc }
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
 apiKey:"AIzaSyBQpzc5xAvInmSCbzsZiy7TpD0OXVyij_4",
 authDomain:"jb-rrms-membership-system.firebaseapp.com",
 projectId:"jb-rrms-membership-system",
 storageBucket:"jb-rrms-membership-system.firebasestorage.app",
 messagingSenderId:"493815911364",
 appId:"1:493815911364:web:e8f2270cf73d93dd368a91"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadMembers(){

 let lst=document.getElementById("memberList");
 lst.innerHTML="‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...";

 const q = await getDocs(collection(db,"members"));
 lst.innerHTML="";

 q.forEach(d=>{

 let m=d.data();

 let div=document.createElement("div");
 div.className="card";

 div.innerHTML=`
 <p><b>‡§®‡§æ‡§Æ:</b> ${m.name}</p>
 <p><b>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤:</b> ${m.mobile}</p>
 <p><b>‡§™‡§§‡§æ:</b> ${m.address}</p>
 <p><b>‡§™‡§¶:</b> ${m.role}</p>
 <p class="status">‡§∏‡•ç‡§ü‡•á‡§ü‡§∏: ${m.status}</p>

 <button class="approve">Approve</button>
 <button class="reject">Reject</button>
 <button class="delete">Delete</button>
 `;

 div.querySelector(".approve").onclick=()=>updateMember(d.id,"approved");
 div.querySelector(".reject").onclick=()=>updateMember(d.id,"rejected");
 div.querySelector(".delete").onclick=()=>removeMember(d.id);

 lst.appendChild(div);

 });

}

async function updateMember(id,status){
 await updateDoc(doc(db,"members",id),{status:status});
 alert("Updated Successfully");
 loadMembers();
}

async function removeMember(id){
 if(confirm("Delete Member?")){
  await deleteDoc(doc(db,"members",id));
  alert("Deleted");
  loadMembers();
 }
}

loadMembers();

</script>

</body>
</html>
