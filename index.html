<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>JB RRMS Membership System</title>

<style>
body{font-family:Arial;background:#eef3ff;margin:0}
header{background:#c72e1f;color:#fff;padding:15px;text-align:center}
.container{max-width:900px;margin:auto;padding:15px}
.card{background:#fff;padding:18px;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,.12);margin-bottom:18px}
input{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:1px solid #bbb}
button{padding:10px 14px;border:none;border-radius:8px;background:#1f36c7;color:#fff;cursor:pointer}
button:hover{background:#162aa1}
.hidden{display:none}
.logo{width:140px;border-radius:12px}
.social a{padding:10px;display:inline-block;text-decoration:none;font-weight:bold}
.whatsapp{color:green}
.fb{color:#1877f2}
</style>
</head>

<body>

<header>
<h2>рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛</h2>
</header>

<div class="container">

<div id="home" class="card">
<center>
<img src="LOGO_LINK_HERE" class="logo"><br><br>
<h3>ЁЯЪй рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ ЁЯЪй</h3>

<div class="social">
<a class="whatsapp" href="https://wa.me/9166377972" target="_blank">ЁЯУЮ WhatsApp</a>
<a class="fb" href="https://facebook.com" target="_blank">ЁЯУШ Facebook</a>
</div>
</center>

<hr>

<button onclick="showObjective()">ЁЯОп рдЙрджреНрджреЗрд╢реНрдп</button>
<button onclick="showExecutive()">ЁЯСе рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА</button>

</div>


<div id="objective" class="card hidden">
<button onclick="goBack()">тмЕ рд╡рд╛рдкрд╕</button>
<h3>ЁЯОп рд╕рдВрдЧрдарди рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп</h3>
<p>рд░рд╛рдЬрдкреВрдд рд╕рдорд╛рдЬ рдХреЗ рд╕реНрд╡рд╛рднрд┐рдорд╛рди, рдПрдХрддрд╛ рдФрд░ рд╕рдВрдЧрдарди рдХреА рдордЬрдмреВрддреА рд╣рдорд╛рд░рд╛ рд▓рдХреНрд╖реНрдп рд╣реИред</p>
</div>


<div id="executive" class="card hidden">
<button onclick="goBack()">тмЕ рд╡рд╛рдкрд╕</button>
<h3>ЁЯСе рд░рд╛рд╖реНрдЯреНрд░реАрдп рдХрд╛рд░реНрдпрдХрд╛рд░рд┐рдгреА</h3>
<p><b>рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╣реЗрд▓реНрдкрд▓рд╛рдЗрди:</b> 9166377972</p>
</div>


<div class="card">
<h3>рдСрдирд▓рд╛рдЗрди рд╕рджрд╕реНрдпрддрд╛ рдлреЙрд░реНрдо</h3>
<input id="mName" placeholder="рдкреВрд░рд╛ рдирд╛рдо">
<input id="mFather" placeholder="рдкрд┐рддрд╛ рдХрд╛ рдирд╛рдо">
<input id="mPhone" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░">
<input id="mEmail" placeholder="рдИрдореЗрд▓">
<input id="mDistrict" placeholder="рдЬрд┐рд▓рд╛">
<input id="mPhoto" type="file">
<button onclick="joinMember()">Save</button>
</div>


<div class="card">
<h3>рд╕рджрд╕реНрдп рд▓реЙрдЧрд┐рди (OTP)</h3>
<input id="loginMobile" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░">
<div id="recaptcha"></div>
<button onclick="sendOTP()">Send OTP</button>
<input id="otpCode" placeholder="OTP рджрд░реНрдЬ рдХрд░реЗрдВ">
<button onclick="verifyOTP()">Verify & Login</button>
</div>


<div id="memberPanel" class="card hidden">
<h3>рд╕реНрд╡рд╛рдЧрдд рд╣реИ ЁЯЩП</h3>

<img id="profilePic" width="120" style="border-radius:10px"><br>

<p><b>рдирд╛рдо :</b> <span id="pName"></span></p>
<p><b>рдореЛрдмрд╛рдЗрд▓ :</b> <span id="pPhone"></span></p>
<p><b>рдЬрд┐рд▓рд╛ :</b> <span id="pDistrict"></span></p>

<button onclick="downloadID()">ЁЯЖФ ID Card</button>
<button onclick="downloadCert()">ЁЯОУ Certificate</button>
<button onclick="downloadLetter()">ЁЯУЬ Appointment Letter</button>

<br><br>
<button onclick="memberLogout()">Logout</button>
</div>


<div class="card">
<h3>Admin Login</h3>
<input id="adminEmail" placeholder="Email">
<input id="adminPass" type="password" placeholder="Password">
<button onclick="adminLogin()">Login</button>
</div>


<div id="adminPanel" class="card hidden">
<h3>рд╕рднреА рд╕рджрд╕реНрдп</h3>
<div id="memberList"></div>
<button onclick="adminLogout()">Logout</button>
</div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script type="module">

import {initializeApp} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {getAuth,signInWithPhoneNumber,RecaptchaVerifier,signInWithEmailAndPassword,signOut,onAuthStateChanged}
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import {getFirestore,addDoc,collection,query,where,getDocs}
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
import {getStorage,ref,uploadBytes,getDownloadURL}
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-storage.js";

const firebaseConfig={
  apiKey:"AIzaSyBQpzc5xAvInmSCbzsZiy7TpD0OXVyij_4",
  authDomain:"jb-rrms-membership-system.firebaseapp.com",
  projectId:"jb-rrms-membership-system",
  storageBucket:"jb-rrms-membership-system.appspot.com",
  messagingSenderId:"493815911364",
  appId:"1:493815911364:web:e8f2270cf73d93dd368a91"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);
const storage=getStorage(app);

const mName=document.getElementById("mName");
const mFather=document.getElementById("mFather");
const mPhone=document.getElementById("mPhone");
const mEmail=document.getElementById("mEmail");
const mDistrict=document.getElementById("mDistrict");
const mPhoto=document.getElementById("mPhoto");
const loginMobile=document.getElementById("loginMobile");
const otpCode=document.getElementById("otpCode");

let confirmation;

/* RECAPTCHA */
window.recaptchaVerifier=new RecaptchaVerifier(auth,"recaptcha",{size:"normal"});


/* SAVE MEMBER */
window.joinMember=async()=>{
 try{
 let file=mPhoto.files[0];
 let r=ref(storage,"photos/"+Date.now());
 await uploadBytes(r,file);
 let url=await getDownloadURL(r);

 await addDoc(collection(db,"members"),{
  name:mName.value,
  father:mFather.value,
  phone:"+91"+mPhone.value,
  email:mEmail.value,
  district:mDistrict.value,
  photo:url
 });

 alert("Member Registered Successfully ЁЯОЙ");
 }catch(e){
  alert(e.message);
 }
}

/* OTP SEND */
window.sendOTP=async()=>{
 try{
  confirmation=await signInWithPhoneNumber(auth,"+91"+loginMobile.value,window.recaptchaVerifier);
  alert("OTP Sent");
 }catch(e){
  alert(e.message);
 }
}

/* VERIFY OTP */
window.verifyOTP=async()=>{
 try{
  await confirmation.confirm(otpCode.value);
  loadProfile();
 }catch(e){
  alert("рдЧрд▓рдд OTP");
 }
}

/* LOAD MEMBER */
async function loadProfile(){
 const q=query(collection(db,"members"),where("phone","==","+91"+loginMobile.value));
 const s=await getDocs(q);

 s.forEach(d=>{
  memberPanel.classList.remove("hidden");
  pName.innerText=d.data().name;
  pPhone.innerText=d.data().phone;
  pDistrict.innerText=d.data().district;
  profilePic.src=d.data().photo;
  window.memData=d.data();
 });
}

window.memberLogout=()=>signOut(auth);


/* ADMIN LOGIN */
window.adminLogin=()=>signInWithEmailAndPassword(auth,adminEmail.value,adminPass.value);
window.adminLogout=()=>signOut(auth);

onAuthStateChanged(auth,user=>{
 if(user && user.email==="admin@gmail.com"){
  adminPanel.classList.remove("hidden");
 }else{
  adminPanel.classList.add("hidden");
 }
});


/* PDF */
window.downloadID=()=>{
 const{jsPDF}=window.jspdf;
 let d=new jsPDF();
 d.text("JB RRMS тАУ ID CARD",60,20);
 d.text("Name: "+memData.name,20,40);
 d.text("Phone: "+memData.phone,20,50);
 d.save("ID_CARD.pdf");
}

window.downloadCert=()=>{
 const{jsPDF}=window.jspdf;
 let d=new jsPDF();
 d.text("CERTIFICATE OF MEMBERSHIP",40,40);
 d.text(memData.name+" is a member of JB RRMS",20,60);
 d.save("Certificate.pdf");
}

window.downloadLetter=()=>{
 const{jsPDF}=window.jspdf;
 let d=new jsPDF();
 d.text("APPOINTMENT LETTER",60,40);
 d.text("This certifies "+memData.name,20,60);
 d.save("Appointment_Letter.pdf");
}

</script>

<script>
function showObjective(){home.classList.add("hidden");objective.classList.remove("hidden")}
function showExecutive(){home.classList.add("hidden");executive.classList.remove("hidden")}
function goBack(){home.classList.remove("hidden");objective.classList.add("hidden");executive.classList.add("hidden")}
</script>

</body>
</html>
