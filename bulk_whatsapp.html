<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Bulk WhatsApp | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f4f4f4;margin:0}
.box{
  max-width:1000px;margin:30px auto;background:#fff;
  padding:20px;border-radius:10px
}
h2{color:#25D366;text-align:center}
textarea{
  width:100%;height:120px;
  font-size:13px;margin:10px 0;
  font-family:Arial
}
table{width:100%;border-collapse:collapse;font-size:13px}
th,td{border:1px solid #ccc;padding:6px;text-align:left}
th{background:#eee}
.btn{
  padding:8px 14px;background:#25D366;
  color:#fff;border:none;border-radius:6px;
  cursor:pointer;margin-top:10px
}
.note{font-size:12px;color:#555;margin:8px 0}
.count{font-size:13px;margin:6px 0}
</style>
</head>

<body>

<div class="box">
<h2>ЁЯУ▓ Bulk WhatsApp Sender (Approved Members)</h2>

<div class="note">
тЪая╕П WhatsApp рдПрдХ-рдПрдХ рдХрд░рдХреЗ tabs рдореЗрдВ рдЦреБрд▓реЗрдЧрд╛ред  
Send рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ message check рдХрд░реЗрдВред
</div>

<div class="count">
Total Approved Members: <b id="cnt">0</b>
</div>

<label><b>Message Template:</b></label>
<textarea id="msg">
ЁЯЩП рдЬрдп рднрд╡рд╛рдиреА | рдЬрдп рд░рд╛рдЬрдкреВрддрд╛рдирд╛ ЁЯЪй

рдЖрдкрдХрд╛ рд╕рджрд╕реНрдпрддрд╛ рд╡рд┐рд╡рд░рдг рдЬрд╛рд░реА рд╣реЛ рдЧрдпрд╛ рд╣реИ тЬЕ

рдирд╛рдо: {{name}}
рдкрдж: {{post}}
Member ID: {{id}}

Verify ЁЯСЗ
https://jbrrms.in/verify.html?id={{id}}
</textarea>

<table id="tbl">
<thead>
<tr>
<th>Send</th>
<th>Name</th>
<th>Mobile</th>
<th>Post</th>
<th>Member ID</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button class="btn" onclick="send()">Send Selected</button>
</div>

<script>
let members=[];

fetch("data/members.json")
.then(r=>r.json())
.then(d=>{
  members=d.filter(m => (m.status||"").toLowerCase()==="approved");
  document.getElementById("cnt").innerText = members.length;

  const tb=document.querySelector("#tbl tbody");
  members.forEach((m,i)=>{
    const mid = m.member_id || m.memberId || "";
    const mob = (m.mobile||"").replace(/\D/g,"");

    if(mob.length<10) return;

    tb.innerHTML+=`
      <tr>
        <td><input type="checkbox" data-i="${i}" checked></td>
        <td>${m.name||""}</td>
        <td>${mob}</td>
        <td>${m.post||""}</td>
        <td>${mid}</td>
      </tr>`;
  });
});

function send(){
  const tpl=document.getElementById("msg").value;
  const checked=document.querySelectorAll("input[type=checkbox]:checked");

  if(!checked.length){
    alert("тЭМ рдХреЛрдИ member select рдирд╣реАрдВ рд╣реИ");
    return;
  }

  checked.forEach(cb=>{
    const m=members[cb.dataset.i];
    const mid = m.member_id || m.memberId;
    const mob = (m.mobile||"").replace(/\D/g,"");

    let text = tpl
      .replaceAll("{{name}}", m.name||"")
      .replaceAll("{{post}}", m.post||"")
      .replaceAll("{{id}}", mid||"");

    window.open(
      "https://wa.me/91"+mob+"?text="+encodeURIComponent(text),
      "_blank"
    );
  });
}
</script>

<footer style="text-align:center;font-size:13px;color:#555;margin:30px 0">
┬й 2025 рдЬрдп рднрд╡рд╛рдиреА рд░рд╛рд╖реНрдЯреНрд░реАрдп рд░рд╛рдЬрдкреВрдд рдорд╣рд╛рд╕рднрд╛<br>
рдпрд╣ рдЯреВрд▓ рдХреЗрд╡рд▓ Admin рдЙрдкрдпреЛрдЧ рд╣реЗрддреБ рд╣реИред
</footer>

</body>
</html>
