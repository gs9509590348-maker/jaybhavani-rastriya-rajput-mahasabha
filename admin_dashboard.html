<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard | JBRRMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,Arial;background:#f4f4f4}

/* HEADER */
header{
  background:#7b0000;color:#fff;
  padding:16px;text-align:center;
  position:relative
}
header h2{margin:0}
header p{margin:6px 0 0;font-size:13px}
.logout{
  position:absolute;right:15px;top:15px;
  background:#fff;color:#7b0000;
  border:none;border-radius:6px;
  padding:6px 10px;font-size:13px;
  cursor:pointer
}

/* NAV */
nav{
  background:#3b0000;
  display:flex;flex-wrap:wrap;
  justify-content:center
}
nav a{
  color:#fff;text-decoration:none;
  padding:8px 12px;font-size:14px
}
nav a:hover{background:#7b0000}

/* MAIN */
.container{
  max-width:1100px;margin:20px auto;
  padding:10px
}
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:14px
}
.card{
  background:#fff;border-radius:10px;
  padding:18px;text-align:center;
  box-shadow:0 2px 6px rgba(0,0,0,.1)
}
.card h3{margin:0;font-size:26px}
.card p{margin:6px 0 0;font-size:13px;color:#555}

.green{border-top:5px solid #28a745}
.red{border-top:5px solid #dc3545}
.blue{border-top:5px solid #0066cc}
.orange{border-top:5px solid #ff9800}

.section{
  background:#fff;border-radius:10px;
  padding:18px;margin-top:20px;
  box-shadow:0 2px 6px rgba(0,0,0,.1)
}
.section h3{margin-top:0;color:#7b0000}

.quick a{
  display:inline-block;margin:6px;
  padding:10px 14px;border-radius:6px;
  background:#7b0000;color:#fff;
  text-decoration:none;font-size:14px
}
.quick a.gray{background:#555}
.quick a.green{background:#28a745}
.quick a.blue{background:#0066cc}

/* CHART */
.chart{
  max-width:420px;margin:auto
}

/* FOOTER */
footer{
  text-align:center;font-size:12px;
  color:#555;margin:30px 10px
}
</style>
</head>

<body>

<script>
/* ğŸ” SESSION CHECK */
if(sessionStorage.getItem("admin")!=="1"){
  alert("âŒ Unauthorized Access");
  location.href="admin_login.html";
}
</script>

<header>
  <button class="logout" onclick="logout()">ğŸšª Logout</button>
  <h2>ğŸ“Š Admin Dashboard</h2>
  <p>Jay Bhavani Rashtriya Rajput Mahasabha</p>
</header>

<nav>
  <a href="admin_dashboard.html">ğŸ“Š Dashboard</a>
  <a href="admin_pending.html">â³ Pending</a>
  <a href="admin_bulk_approve.html">ğŸš€ Bulk Approve</a>
  <a href="bulk_add_members.html">â• Bulk Add</a>
  <a href="bulk_whatsapp.html">ğŸ“² WhatsApp</a>
  <a href="../verify.html" target="_blank">ğŸ” Verify</a>
  <a href="../index.html" target="_blank">ğŸ  Website</a>
</nav>

<div class="container">

<!-- STATS -->
<div class="cards">
  <div class="card blue"><h3 id="total">0</h3><p>Total Members</p></div>
  <div class="card green"><h3 id="approved">0</h3><p>Approved</p></div>
  <div class="card red"><h3 id="pending">0</h3><p>Pending</p></div>
  <div class="card orange"><h3 id="kcount">0</h3><p>à¤•à¤¾à¤°à¥à¤¯à¤•à¤¾à¤°à¤¿à¤£à¥€</p></div>
</div>

<!-- CHART -->
<div class="section">
  <h3>ğŸ“Š Member Status Chart</h3>
  <div class="chart">
    <canvas id="statusChart"></canvas>
  </div>
</div>

<!-- QUICK -->
<div class="section">
  <h3>âš¡ Quick Actions</h3>
  <div class="quick">
    <a href="#" onclick="exportCSV()">ğŸ§¾ Export CSV</a>
    <a href="admin_bulk_approve.html" class="green">ğŸš€ Bulk Approve</a>
    <a href="bulk_whatsapp.html" class="blue">ğŸ“² WhatsApp</a>
  </div>
</div>

</div>

<footer>
Â© 2026 à¤œà¤¯ à¤­à¤µà¤¾à¤¨à¥€ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤°à¤¾à¤œà¤ªà¥‚à¤¤ à¤®à¤¹à¤¾à¤¸à¤­à¤¾<br>
Admin Dashboard â€“ Authorized Use Only
</footer>

<!-- CHART JS CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const totalEl=document.getElementById("total");
const approvedEl=document.getElementById("approved");
const pendingEl=document.getElementById("pending");
const kcountEl=document.getElementById("kcount");

let chart;

/* ===== LOGOUT ===== */
function logout(){
  sessionStorage.removeItem("admin");
  location.href="admin_login.html";
}

/* ===== LOAD STATS ===== */
async function loadStats(){
  const members=await fetch("../data/members.json?v="+Date.now()).then(r=>r.json());
  const kar=await fetch("../data/karyakarini.json?v="+Date.now()).then(r=>r.json());

  let approved=0,pending=0;
  members.forEach(m=>{
    (m.status||"pending").toLowerCase()==="approved"?approved++:pending++;
  });

  totalEl.innerText=members.length;
  approvedEl.innerText=approved;
  pendingEl.innerText=pending;
  kcountEl.innerText=(kar.karyakarini||[]).length;

  drawChart(approved,pending);
}

/* ===== CHART ===== */
function drawChart(a,p){
  if(chart) chart.destroy();
  chart=new Chart(
    document.getElementById("statusChart"),
    {
      type:"pie",
      data:{
        labels:["Approved","Pending"],
        datasets:[{
          data:[a,p],
          backgroundColor:["#28a745","#ff9800"]
        }]
      }
    }
  );
}

/* ===== EXPORT CSV ===== */
async function exportCSV(){
  const data=await fetch("../data/members.json").then(r=>r.json());
  let csv="Member ID,Name,Mobile,Status\n";
  data.forEach(m=>{
    csv+=`${m.member_id},${m.name},${m.mobile},${m.status}\n`;
  });
  const blob=new Blob([csv],{type:"text/csv"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="members.csv";
  a.click();
}

/* ===== AUTO REFRESH (30s) ===== */
loadStats();
setInterval(loadStats,30000);
</script>

</body>
</html>
